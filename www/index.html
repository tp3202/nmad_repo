<!DOCTYPE html>
<!--
    Copyright (c) 2012-2014 Adobe Systems Incorporated. All rights reserved.

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
		
		<script type="text/javascript" src="cordova-1.7.0.js"></script>
	<script type="text/javascript" src="http://	maps.googleapis.com/maps/api/js?key=AIzaSyDD353fOPh-KBUQ-2ekPCg75uxXRn0D9Tk&sensor=false"></script>
	<script type="text/javascript" src="json2.js"></script>
	<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="jquery.mobile-1.1.0.min.js"></script>
    <script type="text/javascript" src="index.js"></script>
	<link rel="stylesheet" href="jquery.mobile-1.1.0.min.css" />
		<script src="openfb.js"></script>
		
<script src="openfb.js"></script>

<script>
  // Defaults to sessionStorage for storing the Facebook token
     //openFB.init({appId: ''});
    //  Uncomment the line below to store the Facebook token in localStorage instead of sessionStorage
	//1565772343686746
	//1552445581686089
	//nmad demo 811842908898811
      openFB.init({appId: '1552445581686089', tokenStore: window.localStorage});
    function login() {
        openFB.login(
                function(response) {
                    if(response.status === 'connected') {
                        alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
						window.location = "index.html#Profile";
                    } else {
                        alert('Facebook login failed: ' + response.error);
                    }
                }, {scope: 'email,read_stream,publish_stream,user_birthday,user_hometown,user_work_history,user_education_history,user_location'});
    }
	
		
		/*			<label for="track_id">Name:</label>
						<img id="userPic"/>
						<input type="text" name="userName" id="userName" placeholder="Name"/>						
						<input type="text" name="age" id="Age" placeholder="Age"/> 
						<input type="text" name="Gender" id="Gender" placeholder="Gender"/> 
						<input type="text" name="Occupation" id="Occupation" placeholder="Occupation"/>
						<input type="text" name="Industry" id="Industry" placeholder="Industry"/> 						
						<input type="text" name="WorkHistory" id="WorkHistory" placeholder="Company"/> 
						<input type="text" name="HomeTown" id="HomeTown" placeholder="Where are you from"/>	
						<input type="text" name="About" id="About" placeholder="about you"/>	
						<input type="text" name="Education" id="Education" placeholder="Alma Mater" />*/
    function getInfo() {
        openFB.api({
            path: '/me',
            success: function(data) {
                console.log(JSON.stringify(data));
					console.log("test work");
				console.log(data.education[data.education.length-1].school.name);
				//me?fields=about,birthday,education,address,email,first_name,last_name,gender,hometown,id,work
                document.getElementById("userName").value = data.name;
                document.getElementById("userPic").src = 'http://graph.facebook.com/' + data.id + '/picture?type=large';
				document.getElementById("Age").value = data.birthday;
				//Gender
				document.getElementById("Gender").value = data.gender;
				document.getElementById("WorkHistory").value = data.work[0].employer.name
				document.getElementById("HomeTown").value = data.hometown.name;
				document.getElementById("Education").value = data.education[data.education.length-1].school.name
				
				
				//alert(1);
            },
            error: errorHandler});
    }
    function share() {
        openFB.api({
            method: 'POST',
            path: '/me/feed',
            params: {
                message: document.getElementById('Message').value || 'Testing Facebook APIs'
            },
            success: function() {
                alert('the item was posted on Facebook');
            },
            error: errorHandler});
    }
    function revoke() {
        openFB.revokePermissions(
                function() {
                    alert('Permissions revoked');
                },
                errorHandler);
    }
    function logout() {
        openFB.logout(
                function() {
                    alert('Logout successful');
                },
                errorHandler);
    }
    function errorHandler(error) {
        alert(error.message);
    }
	
	function btnCreateAccount_click(){ 
	alert("email/0/password1" + $( ".email" ).val()+ 0 + $( ".password1" ).val()); 
	  var xmlHttp = null;
//http://localhost:64785/Nomad.svc/adduser/1233/0/1232
    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", "http://localhost:64785/Nomad.svc/adduser/" + $( ".email" ).val()+"/" + "0/"+$( ".password1" ).val(), false );
    xmlHttp.send( null );
    alert("response 1"+xmlHttp.responseText);
	}
	
/*
    openFB.init('1552445581686089'); // Defaults to sessionStorage for storing the Facebook token

//  Uncomment the line below to store the Facebook token in localStorage instead of sessionStorage
  //openFB.init('1552445581686089', 'https://dl.dropboxusercontent.com/u/32423176/Nmad_Dev/www/index.html', window.localStorage);

    function login() {

        openFB.login('email',
                function() {
                    alert('Facebook login succeeded');
                },
                function() {
                    alert('Facebook login failed');
                });
    }

    function getInfo() {
        openFB.api({
            path: '/me',
            success: function(data) {
                console.log(JSON.stringify(data));
                document.getElementById("userName").innerHTML = data.name;
            },
            error: errorHandler});
    }

    function share() {
        openFB.api({
            method: 'POST',
            path: '/me/feed',
            params: {
                message: 'Testing Facebook APIs'
            },
            success: function(data) {
                alert('the item was posted on Facebook');
            },
            error: errorHandler});
    }

    function revoke() {
        openFB.revokePermissions(
                function() {
                    alert('Permissions revoked');
                },
                errorHandler);
    }

    function errorHandler(error) {
        alert(error.message);
    }
*/
</script>
        <title>Nomad</title>
    </head>
    <body>
		<div data-role="page" id="SignUp">
			<div data-role="header">
				<h1>Create Account</h1>	
				<!--NAV-->
				<div data-role="navbar">
					<ul>
						<li><a href="#SignUp" data-transition="none" data-icon="home">Join</a></li>
						<li><a href="#SignIn" data-transition="none" data-icon="plus">Sign In</a></li>
					</ul>
				</div>
				<!--NAV-->
			</div>
 
			<div data-role="content">	
				<p id="startTracking_status"></p>
					<div data-role="fieldcontain" class="ui-hide-label">
						<label for="track_id">Name:</label>
						<input type="text" name="email" class ="email" id="email" placeholder="Email"/>						
						<input type="text" name="password1" class="password1" id="password1" placeholder="Password"/>
						<input type="text" name="password2" id="password2" placeholder="Confirm Password"/> 
						<button class="btn btn-block" onclick="login()">Login with Facebook</button>
						<button class="btn btn-block" onclick="revoke()">Revoke Permissions</button>
						<!--<button class="btn btn-block" onclick="getInfo()">Get My Info</button>
<p>Name: <span id="userName"></span></p>
<img id="userPic"/>-->
					</div>
					<div style="width:50%; margin-left:25%;">
					<button data-role="button" style="width:50% !important;" id="btnCreateAccount" onclick="btnCreateAccount_click()">Join Nomad!</button>
					</div>
			</div>
		</div> 
 <!----------------------------------------------------------------------------------------- /page ----------------------------------------------------------------------------------------------------->
 <!----------------------------------------------------------------------------------------- /page ----------------------------------------------------------------------------------------------------->
 <!----------------------------------------------------------------------------------------- /page ----------------------------------------------------------------------------------------------------->
		<div data-role="page" id="SignIn">
			<div data-role="header">
				<h1>Welcome Back!</h1>	
				<!--NAV-->
				<div data-role="navbar">
					<ul>
						<li><a href="#SignUp" data-transition="none" data-icon="home">Join</a></li>
						<li><a href="#SignIn" data-transition="none" data-icon="plus">Sign In</a></li>
					</ul>
				</div>
				<!--NAV-->
			</div>
			
		<script>
		  /*window.fbAsyncInit = function() {
			FB.init({
			  appId      : '1552445581686089',
			  xfbml      : true,
			  version    : 'v2.2'
			});
		  };

		  (function(d, s, id){
			 var js, fjs = d.getElementsByTagName(s)[0];
			 if (d.getElementById(id)) {return;}
			 js = d.createElement(s); js.id = id;
			 js.src = "//connect.facebook.net/en_US/sdk.js";
			 fjs.parentNode.insertBefore(js, fjs);
		   }(document, 'script', 'facebook-jssdk'));*/
		</script>
		<script>/*
  // This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {
    alert('statusChangeCallback');
    alert(response);
    // The response object is returned with a status field that lets the
    // app know the current login status of the person.
    // Full docs on the response object can be found in the documentation
    // for FB.getLoginStatus().
    if (response.status === 'connected') {
      alert('3');
      testAPI();
    } else if (response.status === 'not_authorized') {
      // The person is logged into Facebook, but not your app.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into this app.';
    } else {
      // The person is not logged into Facebook, so we're not sure if
      // they are logged into this app or not.
      document.getElementById('status').innerHTML = 'Please log ' +
        'into Facebook.';
    }
  }

  // This function is called when someone finishes with the Login
  // Button.  See the onlogin handler attached to it in the sample
  // code below.
  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '1552445581686089',
    cookie     : true,  // enable cookies to allow the server to access 
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v2.2' // use version 2.2
  });

  // Now that we've initialized the JavaScript SDK, we call 
  // FB.getLoginStatus().  This function gets the state of the
  // person visiting this page and can return one of three states to
  // the callback you provide.  They can be:
  //
  // 1. Logged into your app ('connected')
  // 2. Logged into Facebook, but not your app ('not_authorized')
  // 3. Not logged into Facebook and can't tell if they are logged into
  //    your app or not.
  //
  // These three cases are handled in the callback function.

  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  // Load the SDK asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  // Here we run a very simple test of the Graph API after login is
  // successful.  See statusChangeCallback() for when this call is made.
  function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log('Successful login for: ' + response.name);
      document.getElementById('status').innerHTML =
        'Thanks for logging in, ' + response.name + '!';
    });
  }
  
 
});

FB.login(function(response) {
  if (response.status === 'connected') {
    window.location.href("#Profile");
	alert('1');
  } else if (response.status === 'not_authorized') {
    alert('2');
  } else {
    // The person is not logged into Facebook, so we're not sure if
    // they are logged into this app or not.
  }
});*/
</script>
<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->


<div id="status">
</div>
			<div data-role="content">	
				
					<div data-role="fieldcontain" class="ui-hide-label">
						<label for="track_id">Name:</label>
						<input type="text" name="id" id="Email" placeholder="Email"/>						
						<input type="text" name="password1" id="Password" placeholder="Password"/>
						
						<div id="fb-root"></div>

						<div class="fb-login-button" data-max-rows="1" data-size="medium" data-show-faces="false" data-auto-logout-link="false"></div>
					</div>
					<div style="width:50%; margin-left:25%;">
					<button data-role="button" style="width:50% !important;" id="btnCreateAccount">Sign In</button>
					</div>
			</div>
		</div><!-- /page -->
		
		
		<div data-role="page" id="Profile">
			<div data-role="header">
				<h1>Your Profile</h1>	
				<!--NAV-->
				<div data-role="navbar">
					<ul>
						<!--<li><a href="#SignUp" data-transition="none" data-icon="home">Join</a></li>
						<li><a href="#SignIn" data-transition="none" data-icon="plus">Sign In</a></li>-->
					</ul>
				</div>
				<!--NAV-->
			</div>

			<div data-role="content">	 
				<!-- -->
				<p>Build the profile that others will see</p>
					<div data-role="fieldcontain" class="ui-hide-label">
						<label for="track_id">Name:</label>
						<img id="userPic"/></br>
						<input type="text" name="userName" id="userName" placeholder="Name"/>						
						<input type="text" name="age" id="Age" placeholder="Age"/> 
						<input type="text" name="Gender" id="Gender" placeholder="Gender"/> 
						<input type="text" name="Occupation" id="Occupation" placeholder="Occupation"/>
						<input type="text" name="Industry" id="Industry" placeholder="Industry"/> 						
						<input type="text" name="WorkHistory" id="WorkHistory" placeholder="Company"/> 
						<input type="text" name="HomeTown" id="HomeTown" placeholder="Where are you from"/>	
						<input type="text" name="About" id="About" placeholder="about you (e.g. 'I Love Hiking')"/>	
						<input type="text" name="Education" id="Education" placeholder="Alma Mater" />
						
												<button class="btn btn-block" onclick="getInfo()">Get My Info</button>
<!--<p>Name: <span id="userName"></span></p>-->

						
					</div>
					<div style="width:50%; margin-left:25%;">
					<button data-role="button" style="width:50% !important;" id="btnUpdateProfile">Update Profile!</button>
					</div>
			</div>
		</div><!-- /page -->
    </body>
</html>
